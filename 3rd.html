<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>points show</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: "Tajawal", sans-serif;
  margin: 0; padding: 0;
  background: url("https://i.ibb.co/0yZqDqzf/colorful-flat-comic-style-background-free-vector.jpg") no-repeat center center fixed;
  background-size: cover;
  display: flex; justify-content: center; align-items: center;
  height: 100vh; flex-direction: column;
  overflow: hidden;
}
@keyframes gradientBG {
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
#welcome, #pointsPage {
  display: none;
  text-align: center;
  position: relative;
  z-index: 10;
}
h1 { font-size: 2.4em; color: #2d3436; text-shadow: 2px 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
button {
  background: linear-gradient(45deg, #fd79a8, #e84393);
  color: white; border: none;
  padding: 14px 28px; border-radius: 12px; cursor: pointer;
  font-size: 1.2em; transition: transform 0.3s ease, box-shadow 0.3s ease;
}
button:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}
.container {
  background: rgba(0, 0, 255, 0.12); /* Ø£Ø²Ø±Ù‚ Ø´ÙØ§Ù */
  border: 2px solid #e84393;
  padding: 28px 22px;
  border-radius: 20px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
  width: 95%; max-width: 480px;
  margin-top: 20px; /* ÙŠØ®Ù„ÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ ØªØ­Øª Ø²ÙŠØ²Ùˆ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ */
  box-sizing: border-box;
  z-index: 2;
  position: relative; /* Ù…Ø´ absolute Ø¹Ù„Ø´Ø§Ù† ÙŠØ¨Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
}
input {
  width: 100%; padding: 18px; /* ÙƒØ¨Ø± Ø§Ù„Ø¨Ø§Ø¯ÙŠÙ†Ø¬ */
  border: 1px solid #ccc; border-radius: 14px;
  font-size: 1.3em; /* ÙƒØ¨Ø± Ø§Ù„Ø®Ø· */
  transition: border 0.3s ease, box-shadow 0.3s ease;
  box-sizing: border-box;
}
.suggestions {
  background: #fff; border-radius: 12px; border: 1px solid #ddd;
  max-height: 150px; overflow-y: auto;
}
.suggestions div {
  padding: 10px; cursor: pointer; transition: background 0.3s ease;
  font-size: 1em;
}
.suggestions div:hover { background: #dfe6e9; }
#result {
  background: #f1f2f6;
  padding: 14px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  font-size: 1.2em;
  color: #2d3436;
  transition: opacity 0.5s ease;
}

/* Ø´Ø®ØµÙŠØ© Ø²ÙŠØ²Ùˆ */
#zizo-container {
  position: fixed;
  top: 5vh;
  left: 50%;
  transform: translateX(-50%);
  width: 50vw;
  height: auto;
  z-index: 1;
  pointer-events: none;
  opacity: 0.95;
}
/* ÙÙ‚Ø§Ø¹Ø§Øª */
.float-layer{position:fixed;inset:0;pointer-events:none;z-index:0}
.bubble{
  position:absolute; width:26px; height:26px; border-radius:50%;
  background:rgba(255,255,255,0.7);
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
  animation: rise linear infinite;
}
@keyframes rise{
  0%{transform:translateY(110vh) scale(0.8); opacity:0}
  10%{opacity:1}
  100%{transform:translateY(-20vh) scale(1.2); opacity:0}
}
</style>
</head>
<body>
<!-- ÙÙ‚Ø§Ø¹Ø§Øª -->
<div class="float-layer" id="floatLayer"></div>
  
<!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ÙŠØ© -->
<div id="welcome">
  <h1>ğŸ¯ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ğŸ¯</h1>
  <button onclick="goToPoints()">Ø´ÙˆÙ Ù†Ù‚Ø§Ø·Ùƒ â­</button>
</div>

<!-- ØµÙØ­Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù‚Ø§Ø· -->
<div id="pointsPage">
  <div class="container">
    <h2>Ø´ÙˆÙ Ù†Ù‚Ø§Ø·Ùƒ â­</h2>
    <input id="nameInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
    <div class="suggestions" id="suggestions"></div>
    <button onclick="getPoints()">Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
    <div id="result"></div>
  </div>
</div>

<!-- Ø´Ø®ØµÙŠØ© Ø²ÙŠØ²Ùˆ -->
<div id="zizo-container">
  <video id="zizo-video" autoplay loop muted playsinline style="width:100%; height:100%;">
    <source src="videos/zizo-wave.mp4" type="video/mp4">
  </video>
</div>
<script>
const apiURL = "https://3rd-system-grades.johnmamdouh777.workers.dev";
let allNames = [];

// ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ ØµÙØ­Ø©
window.addEventListener("DOMContentLoaded", () => {
  document.getElementById("welcome").style.display = "block";
  loadNames();
  generateBubbles();
});

async function loadNames() {
  try {
    const res = await fetch(apiURL + "?name=load_names");
    const data = await res.json();
    if (data.names) {
      allNames = data.names;
      console.log("âœ… Loaded Names from server:", allNames); // ğŸ‘ˆ Ù‡Ù†Ø§ Ø¨ÙŠØ·Ø¨Ø¹ ÙƒÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡
    } else {
      console.error("âš ï¸ No names in response:", data);
    }
  } catch (err) {
    console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡", err);
  }
}

// Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ + Ø­Ø§Ù„Ø© Ø§Ù„ØªÙÙƒÙŠØ±
const nameInput = document.getElementById("nameInput");
let isThinking = false; // ÙÙ„ÙØ§Ø¬ Ø¹Ù„Ø´Ø§Ù† Ù†ØªØ­ÙƒÙ… ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ

nameInput.addEventListener("input", () => {
  const val = nameInput.value.trim();
  const box = document.getElementById("suggestions");
  box.innerHTML = "";

  if (val && !isThinking) {
    setZizoState("think"); // Ø²ÙŠØ²Ùˆ ÙŠØ¨Ø¯Ø£ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
    isThinking = true;
  }

  if (!val) {
    isThinking = false; // Ù„Ùˆ Ø±Ø¬Ø¹ ÙØ§Ø¶ÙŠ Ù†Ø±Ø¬Ø¹ Ø§Ù„ÙÙ„ÙØ§Ø¬
    return;
  }

  const matches = allNames.filter(n => n.includes(val)).slice(0,5);
  matches.forEach(name => {
    const div = document.createElement("div");
    div.textContent = name;
    div.onclick = () => { nameInput.value = name; box.innerHTML = ""; };
    box.appendChild(div);
  });
});

// Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ù‚Ø§Ø· + Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯
function goToPoints() {
  setZizoState("ready"); // Ø²ÙŠØ²Ùˆ Ù…ØªØ­Ù…Ø³
  document.getElementById("welcome").style.display = "none";
  document.getElementById("pointsPage").style.display = "block";
}

// Ø¬Ù„Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· + Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø©
async function getPoints() {
  const name = nameInput.value.trim();
  const resultBox = document.getElementById("result");
  if (!allNames.includes(name)) {
    resultBox.innerText = "âŒ Ø§Ù„Ø§Ø³Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„";
    setZizoState("sad"); // Ø²ÙŠØ²Ùˆ Ø­Ø²ÙŠÙ†
    return;
  }

  const res = await fetch(apiURL + "?name=" + encodeURIComponent(name));
  const data = await res.json();
  if (data.error) {
    resultBox.innerText = data.error;
    setZizoState("sad");
  } else {
    resultBox.style.opacity = 0;
    setTimeout(() => {
      resultBox.innerHTML = `
        ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${data.name}<br>
        â­ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ÙƒÙ„ÙŠØ©: ${data.total}<br>
        ğŸ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${data.used}<br>
        â– Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø®ØµÙˆÙ…Ø©: ${data.minus}<br>
        ğŸ† <strong>Ø§Ù„Ù…Ø­ØµÙ„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${data.final}</strong>
      `;
      resultBox.style.opacity = 1;
      setZizoState("win"); // Ø²ÙŠØ²Ùˆ Ø¨ÙŠØ­ØªÙÙ„
    }, 200);
  }
}

// ÙÙ‚Ø§Ø¹Ø§Øª
function generateBubbles() {
  const layer = document.getElementById('floatLayer');
  for(let i=0;i<24;i++){
    const b=document.createElement('div');
    b.className='bubble';
    b.style.left=Math.random()*100+'vw';
    b.style.animationDuration=(10+Math.random()*12)+'s';
    b.style.animationDelay=(Math.random()*5)+'s';
    b.style.opacity=0.6+Math.random()*0.4;
    layer.appendChild(b);
  }
}

// Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø²ÙŠØ²Ùˆ
function setZizoState(state) {
  const video = document.getElementById("zizo-video");
  video.src = "videos/zizo-" + state + ".mp4";
  video.load();
  video.play();
}
</script>
</body>
</html>











